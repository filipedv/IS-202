@model OBLIG1.Models.PointInputModel
@{
    ViewData["Title"] = "Create point";
}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<div class="container py-4">
    <h1 class="h3">Create point</h1>
    <p class="text-muted">Klikk i kartet for Ã¥ velge posisjon. Skjemafeltene fylles automatisk.</p>

    <div id="map" style="height: 360px;" class="mb-3 rounded border"></div>

    <form asp-action="Create" method="post" class="row g-3">
        @Html.AntiForgeryToken()
        <div class="col-md-6">
            <label asp-for="Title" class="form-label"></label>
            <input asp-for="Title" class="form-control"/>
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label asp-for="Latitude" class="form-label"></label>
            <input asp-for="Latitude" class="form-control" step="any"/>
            <span asp-validation-for="Latitude" class="text-danger"></span>
        </div>
        <div class="col-md-3">
            <label asp-for="Longitude" class="form-label"></label>
            <input asp-for="Longitude" class="form-control" step="any"/>
            <span asp-validation-for="Longitude" class="text-danger"></span>
        </div>
        <div class="col-12">
            <button class="btn btn-primary" type="submit">Save</button>
            <a class="btn btn-outline-secondary" asp-action="Index">Cancel</a>
        </div>
    </form>
</div>

@section Scripts {
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
<script>
const map = L.map('map').setView([59.9139, 10.7522], 12); // Oslo
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19, attribution: '&copy; OpenStreetMap'
}).addTo(map);

let marker;
map.on('click', function (e) {
  const {lat, lng} = e.latlng;
  if (marker) marker.setLatLng(e.latlng); else marker = L.marker(e.latlng).addTo(map);
  document.getElementById('Latitude').value = lat.toFixed(6);
  document.getElementById('Longitude').value = lng.toFixed(6);
});
</script>
<partial name="_ValidationScriptsPartial" />
}
