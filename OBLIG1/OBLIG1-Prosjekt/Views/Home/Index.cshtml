@{
    ViewData["Title"] = "Home Page";
}

@section Styles {
    <!-- Leaflet CSS (kun på Home-siden) -->
    <link rel="stylesheet"
          href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          crossorigin="anonymous" />
}

<div class="with-action-footer">
    <div class="home-section rounded shadow-sm">
        <div id="map" class="home-map w-100"></div>
    </div>
</div>

@section PageFooter {
    @* Footer-seksjonen nederst på siden *@
    <div class="position-relative w-100">

        @* VENSTRE: Logout-knapp *@
        @if (User.Identity?.IsAuthenticated ?? false)
        {
            <div class="position-absolute start-0">
                <form asp-controller="Auth"
                      asp-action="Logout"
                      method="post"
                      class="d-inline">

                    @* Anti-forgery token for sikkerhet *@
                    @Html.AntiForgeryToken()

                    @* Knapp for logout *@
                    <button type="submit"
                            class="btn btn-secondary logout-btn">
                        Log out
                    </button>
                </form>
            </div>
        }

        @* MIDTEN: eksisterende knapper, 100% sentrert *@
        <div class="d-flex justify-content-center gap-3">
            <a asp-controller="Obstacle" asp-action="DataForm" class="btn btn-primary">
                Register Obstacle
            </a>
            <a asp-controller="Obstacle" asp-action="Overview" class="btn btn-primary">
                Overview
            </a>
        </div>
    </div>
}

@section Scripts {
    <!-- Leaflet JS (kun på Home-siden) -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            crossorigin="anonymous"></script>

    <script>
        // Oppretter Leaflet-kart i div-en med id="map".
        // Startposisjon er Kristiansand (58.1467, 7.9956) med zoom 13.
        const map = L.map('map').setView([58.1467, 7.9956], 13);

        // Legger til OpenStreetMap som flislag (tile layer)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Oppdaterer kartets størrelse når vinduet endrer størrelse
        window.addEventListener('resize', function () {
            map.invalidateSize();
        });
    </script>
}
