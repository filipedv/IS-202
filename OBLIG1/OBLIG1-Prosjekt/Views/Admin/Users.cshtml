@model IEnumerable<OBLIG1.Models.User>
@{
    Layout = "_Layout";
    ViewData["Title"] = "Admin - Users";
}

<h2>Admin Dashboard</h2>

<style>
    h2 {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 24px;
        color: #333;
    }
    </style>


<div class="users-container">
    <a asp-action="AddUser" class="btn btn-add">Add New User</a>

    <div class="table-wrap">
        <table class="user-table">
            <thead>
                <tr>
                    <th style="width:6%;">Id</th>
                    <th style="width:20%;">Username</th>
                    <th style="width:34%;">Email</th>
                    <th style="width:14%;">Role</th>
                    <th style="width:8%;">Blocked</th>
                    <th style="width:18%;">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model)
                {
                    <tr>
                        <td>@user.Id</td>
                        <td>@user.Username</td>
                        <td>@user.Email</td>
                        <td>@user.Role</td>
                        <td>@(user.IsBlocked ? "Yes" : "No")</td>
                        <td class="actions">
                            <a asp-action="EditUser" asp-route-id="@user.Id" class="btn btn-edit">Edit</a>
                            <a href="javascript:void(0);" onclick="confirmToggleBlock(@user.Id, '@user.Username', @(user.IsBlocked.ToString().ToLower()))" class="btn btn-block">
                                @(user.IsBlocked ? "Unblock" : "Block")
                            </a>
                            <a href="javascript:void(0);" onclick="confirmDelete(@user.Id, '@user.Username')" class="btn btn-delete">Delete</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<style>
.table-wrap {
    overflow-x: auto;
}

.users-container {
    max-width: 100%;
    padding: 16px;
    box-sizing: border-box;
}

.user-table {
    width: 100%;
    border-collapse: collapse;
    min-width: 600px;
}

.user-table th,
.user-table td {
    border: 1px solid #ccc;
    padding: 12px 8px;
    text-align: left;
    white-space: nowrap;
}

.user-table th {
    background-color: #f4f4f4;
}

.actions {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.actions a {
    flex: 1;
    text-decoration: none;
    color: white;
    border-radius: 4px;
    font-size: 14px;
    padding: 6px 0;
    text-align: center;
}

.btn-edit { background-color: #1e90ff; }
.btn-block { background-color: #ff4d4f; }
.btn-delete { background-color: #808080; }
.btn-add { background-color: #4caf50; color: white; padding: 8px 16px; border-radius: 4px; display: inline-block; margin-bottom: 10px;}

<text@media screen and (max-width: 768px) {
    .user-table { font-size: 12px; min-width: unset; }
    .user-table th, .user-table td { padding: 8px 4px; white-space: normal; }
    .actions { flex-direction: column; gap: 4px; }
    .btn-add { width: 100%; text-align: center; }
}
</text>
</style>

@section Scripts {
    <script>
        function confirmDelete(userId, username) {
            if (confirm('Are you sure you want to delete "' + username + '"?')) {
                window.location.href = '/Admin/DeleteUser?id=' + userId;
            }
        }

        function confirmToggleBlock(userId, username, isBlocked) {
            var action = (isBlocked === 'true') ? 'unblock' : 'block';
            if (confirm('Are you sure you want to ' + action + ' "' + username + '"?')) {
                window.location.href = '/Admin/ToggleBlock?id=' + userId;
            }
        }
    </script>
}